{"version":3,"sources":["assets\\sprite\\build.js"],"names":["cc","Class","Component","properties","rect0","Prefab","rect4","rect5","rect7","moveDir","v2","displayName","tooltip","_speedType","JoystickEnum","SpeedType","STOP","type","player","basepoint","button","Node","score","Label","over","sliderv","Slider","audio","AudioClip","onSprite","SpriteFrame","offSprite","bodySprite","onLoad","log","isFood","JoystickEvent","getInstance","on","JoystickEventType","TOUCH_START","onTouchStart","TOUCH_MOVE","onTouchMove","TOUCH_END","onTouchEnd","distance","collider","director","getCollisionManager","enabled","physics","getPhysicsManager","db","PhysicsManager","DrawBits","nodes","find","children","gameState","scoreNum","leftX","rightX","speed","direction","snakeArrX","snakeArrY","snakeArr","nextGoal","goalX","Math","floor","random","goalY","snakeHead","instantiate","getComponent","node","x","y","Group","box","addChild","X","Y","boxMap","i","j","length","round","systemEvent","SystemEvent","EventType","KEY_DOWN","onKeyDown","setGame","event","location","getLocation","firstX","firstY","touchPoint","endX","endY","abs","data","speedType","moveDistance","goal","buildBody","onBeginContact","contact","selfCollider","otherCollider","console","produceFoot","schedule","move","overlapFoot","snakeBody","boxMapX","boxMapY","eatFoot","headX","headY","len","sprite","Sprite","spriteFrame","addScore","string","isGameOver","rotation","moveAll","onCollisionEnter","other","self","keyCode","macro","KEY","a","left","d","right","w","up","s","down","gameOver","active","unschedule","audioEngine","stopAll","pause","replay","loadScene"],"mappings":"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","sourceRoot":"/","sourcesContent":["import JoystickEnum from \"./joystick/JoystickEnum\";\r\nimport JoystickEvent from \"./joystick/JoystickEvent\";\r\n\r\n\r\ncc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        rect0:cc.Prefab,\r\n        rect4:cc.Prefab,\r\n        rect5:cc.Prefab,\r\n        rect7:cc.Prefab,\r\n\r\n    // from joystick\r\n    moveDir: {\r\n        default: cc.v2(0, 1),\r\n        displayName: 'Move Dir',\r\n        tooltip: '移动方向',\r\n    },\r\n    _speedType: {\r\n        default: JoystickEnum.SpeedType.STOP,\r\n        displayName: 'Speed Type',\r\n        type: JoystickEnum.SpeedType,\r\n        tooltip: '速度级别'\r\n    },\r\n       //播放预制资源\r\n       player:cc.Prefab,\r\n       basepoint:cc.Prefab,\r\n       //按钮节点\r\n       button:cc.Node,\r\n       score:cc.Label,\r\n       over:cc.Node,\r\n       //速度调节滑动\r\n       sliderv:cc.Slider,\r\n       //音频\r\n       audio:cc.AudioClip,\r\n       onSprite: {\r\n            default: null,\r\n            type: cc.SpriteFrame\r\n        },\r\n\r\n        offSprite: {\r\n            default: null,\r\n            type: cc.SpriteFrame\r\n        },\r\n\r\n        bodySprite: {\r\n            default: null,\r\n            type: cc.SpriteFrame\r\n        },\r\n\r\n    //    subNodesArr:{\r\n    //         default:[],\r\n    //         type:cc.Prefab,\r\n    //    }\r\n    },\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n    onLoad () {\r\n        cc.log(\"onload start\");\r\n        this.isFood = false;\r\n\r\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_START, this.onTouchStart, this);\r\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_MOVE, this.onTouchMove, this);\r\n        JoystickEvent.getInstance().on(JoystickEnum.JoystickEventType.TOUCH_END, this.onTouchEnd, this);\r\n\r\n        this.distance = 24;\r\n        var collider = cc.director.getCollisionManager();\r\n        collider.enabled = true;\r\n        // collider.enabledDebugDraw = true;\r\n        // collider.enabledDrawBoundingBox = true;\r\n\r\n        //开启物理引擎\r\n        var physics = cc.director.getPhysicsManager();\r\n        physics.enabled = true;\r\n        // physics.gravity.y = 1000;\r\n        var db = cc.PhysicsManager.DrawBits;\r\n\r\n        this.nodes = [];\r\n        this.nodes = cc.find('Canvas/box/nodes').children;\r\n\r\n        //游戏状态  0-暂停 1-运行 2-游戏结束 \r\n        this.gameState = 1;\r\n        cc.director.getCollisionManager().enabled = true;\r\n        cc.director.getPhysicsManager().enabled = true;\r\n        //音效\r\n        //cc.audioEngine.playEffect(this.audio, true);\r\n        //分数\r\n        this.scoreNum=0;\r\n        //边界值\r\n        this.leftX;\r\n        this.rightX;\r\n        //速度\r\n        this.speed=0.4;\r\n        //方向,up-0,down-1,left-2,right-3\r\n        this.direction = 0;\r\n        //贪吃蛇数组,二位数组\r\n        this.snakeArrX=[];\r\n        this.snakeArrY=[];\r\n        this.snakeArr=[];\r\n        //地图上随机生成果实(x,y)坐标\r\n        //this.nextGoal = Math.floor(7*Math.random());\r\n        this.nextGoal = 4;\r\n        this.goalX = Math.floor(15*Math.random());\r\n        this.goalY = Math.floor(10*Math.random());\r\n        //设置贪吃蛇头部\r\n         this.snakeHead = cc.instantiate(this.rect7).getComponent('rect');\r\n         this.snakeHead.node.x=336 + this.distance;\r\n         this.snakeHead.node.y=240 + this.distance;\r\n         this.snakeHead.node.Group = 'hero';\r\n\r\n         var box=cc.find('Canvas/box');\r\n         box.addChild(this.snakeHead.node);\r\n         var X = this.snakeHead.node.x;\r\n         var Y = this.snakeHead.node.y;\r\n\r\n         this.snakeArrX[0]=X - this.distance; \r\n         this.snakeArrY[0]=Y - this.distance;\r\n         this.snakeArr[0] = this.snakeHead;\r\n         //地图\r\n         this.boxMap=[];\r\n         for(let i=0;i<15;i++){\r\n            this.boxMap[i]=[];\r\n            for(let j=0;j<10;j++){\r\n                this.boxMap[i][j]=0;\r\n            }\r\n         }\r\n\r\n         for(let i=0; i<this.nodes.length; i++){\r\n            if(this.nodes[i].Group != 'target'){\r\n                this.boxMap[Math.round(this.nodes[i].x / 48)][Math.round(this.nodes[i].y / 48)]=1;\r\n            } \r\n        }\r\n\r\n        //注册按下监听\r\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\r\n       //this.ontouchmove();\r\n       this.setGame();\r\n\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_START,function(event){\r\n            let location = event.getLocation();// 获取节点坐标\r\n            this.firstX = location.x;\r\n            this.firstY = location.y;\r\n            // 获取触点在空间节点上的坐标\r\n            // var tempPlayer = node.parent.convertToNodeSpaceAR(location);\r\n            // node.setPosition(tempPlayer);\r\n        },this);\r\n\r\n        this.node.on(cc.Node.EventType.TOUCH_END,function(event){\r\n            let touchPoint = event.getLocation();\r\n            let endX = this.firstX - touchPoint.x;\r\n            let endY = this.firstY - touchPoint.y;\r\n            // var tempPlayer = node.parent.convertToNodeSpaceAR(touchPoint);\r\n            // node.setPosition(tempPlayer);\r\n\r\n            if (Math.abs(endX) > Math.abs(endY)){\r\n                //手势向左右\r\n                //判断向左还是向右 \r\n                if (endX  > 0){\r\n                    //向左函数\r\n                    cc.log('left');\r\n                    if(this.direction!=3){\r\n                        this.direction=2;\r\n                    }\r\n                } else {\r\n                    //向右函数\r\n                    cc.log('right');\r\n                    if(this.direction!=2){\r\n                     this.direction=3;\r\n                    }\r\n                }\r\n            } else {\r\n                //手势向上下\r\n                //判断手势向上还是向下\r\n                if (endY  > 0){\r\n                    //向下函数\r\n                    cc.log('down');\r\n                    if(this.direction!=0){\r\n                        this.direction=1;\r\n                    }\r\n                } else {\r\n                    //向上函数\r\n                    cc.log('up');\r\n                    if(this.direction!=1){\r\n                     this.direction=0;\r\n                    }\r\n                }\r\n             }\r\n        },this);\r\n\r\n    },\r\n\r\n    onTouchStart() {\r\n\r\n    },\r\n\r\n    onTouchMove(event, data) {\r\n        this._speedType = data.speedType;\r\n        this.moveDir = data.moveDistance;\r\n        cc.log(\"this.moveDir =\" + this.moveDir);\r\n    },\r\n\r\n    onTouchEnd(event, data) {\r\n        this._speedType = data.speedType;\r\n    },\r\n    //\r\n    setGame(){\r\n        cc.log(\"setGame start\");\r\n         //下个果实方块\r\n         var goal = this.nextGoal;\r\n         this.buildBody(goal);\r\n         cc.log(\"setGame end\");\r\n    },\r\n\r\n    onBeginContact(contact, selfCollider, otherCollider){\r\n        console.log(\"onBeginContact\");\r\n    },\r\n    \r\n\r\n    //获取颜色后实例化6种图像,还有一个种作为head\r\n    buildBody(goal){\r\n        cc.log(\"goal:\"+goal);\r\n        this.produceFoot();\r\n         \r\n         //移动\r\n         this.schedule(this.move,this.speed);\r\n         cc.log(\"goal2:\"+goal);\r\n\r\n    },\r\n    //检测果实生成位置是否重叠贪吃蛇\r\n    overlapFoot(){\r\n        this.goalX = Math.floor(15*Math.random());\r\n        this.goalY = Math.floor(10*Math.random());\r\n        //判断贪吃蛇所有部位是否重叠\r\n        for(let j=0;j<this.snakeArrX.length;j++){\r\n            if(this.boxMap[this.goalX][this.goalY]===1){\r\n                //重新生成，并且重新检测\r\n                this.overlapFoot();\r\n                break;\r\n            }\r\n        }\r\n\r\n        for(let i=0; i<this.nodes.length; i++){\r\n            if(this.nodes[i].x==this.goalX * 48 && this.nodes[i].y==this.goalY * 48){\r\n                this.overlapFoot();\r\n                break;\r\n            }\r\n        }\r\n        this.produceFoot();\r\n    },\r\n    //生成果实\r\n    produceFoot(){\r\n        if(this.isFood){\r\n            return;\r\n        }\r\n\r\n        //this.nextGoal = Math.floor(7*Math.random());\r\n        this.nextGoal = 4;\r\n        //随机生成某种颜色\r\n        //  if(this.nextGoal===0){this.prefab=this.rect0;}\r\n        //  if(this.nextGoal===1){this.prefab=this.rect1;}\r\n        //  if(this.nextGoal===2){this.prefab=this.rect2;}\r\n        //  if(this.nextGoal===3){this.prefab=this.rect3;}\r\n        //  if(this.nextGoal===4){this.prefab=this.rect4;}\r\n        //  if(this.nextGoal===5){this.prefab=this.rect5;}\r\n        //  if(this.nextGoal===6){this.prefab=this.rect6;}\r\n        //贪吃蛇身体\r\n         this.snakeBody = cc.instantiate(this.rect4).getComponent('rect');\r\n         this.snakeBody.node.Group = 'target';\r\n         var box=cc.find('Canvas/box');\r\n         box.addChild(this.snakeBody.node);\r\n         this.isFood = true;\r\n\r\n         this.snakeBody.node.x=this.goalX*48;       \r\n         this.snakeBody.node.y=this.goalY*48;\r\n         //记录地图这里已经有果实\r\n         var boxMapX = this.snakeBody.node.x/48;\r\n         var boxMapY = this.snakeBody.node.y/48;\r\n         this.boxMap[boxMapX][boxMapY]=1;\r\n    },\r\n    //吃到果实\r\n    eatFoot(){\r\n        var headX = this.snakeHead.node.x;\r\n        var headY = this.snakeHead.node.y;\r\n        cc.log(\"headX =\" + headX + \"   headY =\" + headY);\r\n\r\n         var X = (headX - this.distance)/48;\r\n         var Y = (headY - this.distance)/48;\r\n         var boxMapX = Math.round(X);\r\n         var boxMapY = Math.round(Y);\r\n\r\n         cc.log(\"boxMapX =\" + boxMapX);\r\n         cc.log(\"boxMapY =\" + boxMapY);\r\n        //判断是否位置是否有果实\r\n        if(this.boxMap[boxMapX][boxMapY]===1){\r\n            //cc.log(\"位置有果实\");\r\n            //加在尾部\r\n            var len = this.snakeArrX.length;\r\n            this.snakeArrX[len]=this.snakeBody.node.x;\r\n            this.snakeArrY[len]=this.snakeBody.node.y;\r\n            \r\n            // let sprite = this.snakeBody.getComponent(cc.Sprite)\r\n            // sprite.spriteFrame = new cc.SpriteFrame(cc.url.raw('assets/img/5.png'));\r\n            let sprite = this.snakeBody.getComponent(cc.Sprite)\r\n            sprite.spriteFrame = this.bodySprite;\r\n\r\n            this.snakeArr[len]=this.snakeBody;\r\n            //果实被吃了 \r\n            this.boxMap[boxMapX][boxMapY]=0;\r\n            //加分数\r\n            this.addScore();\r\n            //随机生成下一个果实\r\n            this.overlapFoot();\r\n        }\r\n    },\r\n    //加分数\r\n    addScore(){\r\n        //根据不同果实增加分数\r\n        // if(this.nextGoal===0){this.scoreNum+=50;}\r\n        // if(this.nextGoal===1){this.scoreNum+=100;}\r\n        // if(this.nextGoal===2){this.scoreNum+=200;}\r\n        // if(this.nextGoal===3){this.scoreNum+=300;}\r\n        // if(this.nextGoal===4){this.scoreNum+=400;}\r\n        // if(this.nextGoal===5){this.scoreNum+=500;}\r\n        // if(this.nextGoal===6){this.scoreNum+=600;}\r\n        this.scoreNum+=10;\r\n        this.score.string=this.scoreNum;\r\n        this.isFood = false;\r\n    },\r\n    //移动方法\r\n    move (){\r\n        //方向,up-0,down-1,left-2,right-3\r\n\r\n        var X = this.snakeHead.node.x;\r\n        var Y = this.snakeHead.node.y;\r\n        var headX = Math.round(X - this.distance);\r\n        var headY = Math.round(Y - this.distance);\r\n        //cc.log(\"headX =\" + headX + \"  headY =\" + headY);\r\n\r\n        if(this.direction===0){\r\n            //移动前，判断游戏是否结束\r\n            this.isGameOver(headX,headY+48);\r\n            if(this.gameState===1){\r\n                this.snakeHead.node.y+=48; \r\n                this.snakeHead.node.rotation = 0;\r\n            }\r\n            cc.log(\"up\");\r\n        }else if(this.direction===1){\r\n            //移动前，判断游戏是否结束\r\n            this.isGameOver(headX,headY-48);\r\n               \r\n            if(this.gameState===1){\r\n                this.snakeHead.node.y-=48;\r\n                this.snakeHead.node.rotation = 180;\r\n            }\r\n            cc.log(\"down\");\r\n        }else if(this.direction===2){\r\n            this.isGameOver(headX-48,headY);\r\n            \r\n            if(this.gameState===1){\r\n                this.snakeHead.node.x-=48;\r\n                this.snakeHead.node.rotation = 270;\r\n            }\r\n            cc.log(\"left\");\r\n        }else if(this.direction===3){\r\n            //移动前，判断游戏是否结束\r\n            this.isGameOver(headX+48,headY);\r\n             \r\n            if(this.gameState===1){\r\n                this.snakeHead.node.x+=48;\r\n                this.snakeHead.node.rotation = 90;\r\n            }\r\n            cc.log(\"right\");\r\n        }\r\n        if(this.gameState===1){\r\n            this.eatFoot();\r\n            this.moveAll();\r\n        }\r\n    },\r\n    //移动的时候，身体也向头移动\r\n    moveAll(){\r\n        var X = this.snakeHead.node.x;\r\n        var Y = this.snakeHead.node.y;\r\n\r\n        for(let i=this.snakeArrX.length-1;i>0;i--){\r\n            this.snakeArrX[i]=this.snakeArrX[i-1];\r\n            this.snakeArrY[i]=this.snakeArrY[i-1];\r\n        }\r\n        //更新贪吃蛇头部位置,贪吃蛇随头部移动\r\n\r\n        var headX = Math.round(X - this.distance);\r\n        var headY = Math.round(Y - this.distance);\r\n        this.snakeArrX[0]=headX;\r\n        this.snakeArrY[0]=headY;\r\n\r\n        for(let j=1;j<this.snakeArrX.length;j++){\r\n            this.snakeArr[j].node.x=this.snakeArrX[j];\r\n            this.snakeArr[j].node.y=this.snakeArrY[j];\r\n        }\r\n    },\r\n\r\n    onCollisionEnter(other, self) {\r\n        console.log(\"碰撞  =\" + other);\r\n    },\r\n\r\n    //键盘监听\r\n    onKeyDown (event) {\r\n            switch(event.keyCode) {\r\n                case cc.macro.KEY.a:\r\n                case cc.macro.KEY.left:\r\n                   // cc.log(\"key code is  a and left\");\r\n                   if(this.direction!=3){\r\n                        this.direction=2;\r\n                   }\r\n                    break;\r\n                case cc.macro.KEY.d:\r\n                case cc.macro.KEY.right:\r\n                  // cc.log(\"key code is  d and right\");\r\n                   if(this.direction!=2){\r\n                     this.direction=3;\r\n                   }\r\n                    break;\r\n                case cc.macro.KEY.w:\r\n                case cc.macro.KEY.up:\r\n                   // cc.log(\"key code is  w and up\");\r\n                    if(this.direction!=1){\r\n                     this.direction=0;\r\n                    }\r\n                    break;\r\n                case cc.macro.KEY.s:\r\n                case cc.macro.KEY.down:\r\n                   // cc.log(\"key code is  s and down\");\r\n                    if(this.direction!=0){\r\n                        this.direction=1;\r\n                    }\r\n                    break;\r\n            }\r\n    },\r\n    //判断游戏结束的条件\r\n    isGameOver(x,y){\r\n         //判断是否超出地图\r\n\r\n        if(y<0 || y>=480 || x<0 || x>=720){\r\n            this.gameOver();\r\n            return;\r\n        }\r\n\r\n        for(let i=0; i<this.nodes.length; i++){\r\n            if(this.nodes[i].Group != 'target'){\r\n                if(this.nodes[i].x==x && this.nodes[i].y==y){\r\n                    this.gameOver();\r\n                    return;\r\n                }\r\n            } \r\n        }\r\n\r\n        //判断是否碰撞到贪吃蛇身体\r\n        for(let i=0;i<this.snakeArrX.length;i++){\r\n            cc.log(\"this.snakeArrX[i]  =\" + this.snakeArrX[i] + \" x=\" + x);\r\n            cc.log(\"this.snakeArrY[i]  =\" + this.snakeArrY[i] + \" y=\" + y);\r\n\r\n            if(this.snakeArrX[i]==x && this.snakeArrY[i]==y){\r\n                this.gameOver();\r\n                return;\r\n            }\r\n        }\r\n    },\r\n    //游戏结束\r\n    gameOver (){\r\n            cc.log(\"结束\");\r\n            //游戏状态\r\n            this.gameState = 2;\r\n            //将失败的画面显示出来\r\n            this.over.active=true;\r\n            //停止移动\r\n            this.unschedule(this.move);\r\n            //停止所有音乐\r\n            cc.audioEngine.stopAll();\r\n        \r\n    },\r\n    //暂停游戏\r\n    pause(){\r\n        //2表示游戏结束\r\n        if(this.gameState!==2){\r\n            if(this.gameState===1){\r\n                this.gameState=0;\r\n                //this.button.string = \"Play\";\r\n\r\n                let sprite = this.button.getComponent(cc.Sprite)\r\n                sprite.spriteFrame = this.onSprite; \r\n                //停止移动\r\n                this.unschedule(this.move);\r\n            }else if(this.gameState===0){\r\n                this.gameState=1;\r\n                //this.button.string = \"Pause\";\r\n                //停止移动\r\n                this.schedule(this.move,this.speed);\r\n\r\n                let sprite = this.button.getComponent(cc.Sprite)\r\n                sprite.spriteFrame = this.offSprite; \r\n            }\r\n        }\r\n    },\r\n    //重新开始游戏\r\n    replay(){\r\n         //重新加载游戏场景\r\n        cc.director.loadScene(\"snaker\");\r\n    },\r\n});\r\n\r\n"]}