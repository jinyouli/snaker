require=function o(n,r,h){function c(t,e){if(!r[t]){if(!n[t]){var s="function"==typeof require&&require;if(!e&&s)return s(t,!0);if(d)return d(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var a=r[t]={exports:{}};n[t][0].call(a.exports,function(e){return c(n[t][1][e]||e)},a,a.exports,o,n,r,h)}return r[t].exports}for(var d="function"==typeof require&&require,e=0;e<h.length;e++)c(h[e]);return c}({build:[function(e,t,s){"use strict";cc._RF.push(t,"0d94fvvIxZFNogXnBYdjx/r","build"),cc.Class({extends:cc.Component,properties:{rect0:cc.Prefab,rect1:cc.Prefab,rect2:cc.Prefab,rect3:cc.Prefab,rect4:cc.Prefab,rect5:cc.Prefab,rect6:cc.Prefab,rect7:cc.Prefab,player:cc.Prefab,basepoint:cc.Prefab,button:cc.Label,score:cc.Label,over:cc.Node,sliderv:cc.Slider,audio:cc.AudioClip},onLoad:function(){cc.log("onload start"),this.gameState=1,cc.audioEngine.playEffect(this.audio,!0),this.scoreNum=0,this.leftX,this.rightX,this.speed=.5,this.direction=0,this.snakeArrX=[],this.snakeArrY=[],this.snakeArr=[],this.nextGoal=Math.floor(7*Math.random()),this.goalX=Math.floor(10*Math.random()),this.goalY=Math.floor(15*Math.random()),this.snakeHead=cc.instantiate(this.rect7).getComponent("rect"),this.snakeHead.node.x=240,this.snakeHead.node.y=336,cc.find("Canvas/box").addChild(this.snakeHead.node),this.snakeArrX[0]=this.snakeHead.node.x,this.snakeArrY[0]=this.snakeHead.node.y,this.snakeArr[0]=this.snakeHead,this.boxMap=[];for(var e=0;e<10;e++){this.boxMap[e]=[];for(var t=0;t<15;t++)this.boxMap[e][t]=0}cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.setGame(),cc.log("onload end")},setGame:function(){cc.log("setGame start");var e=this.nextGoal;this.buildBody(e),cc.log("setGame end")},buildBody:function(e){cc.log("goal:"+e),this.produceFoot(),this.schedule(this.move,this.speed),cc.log("goal2:"+e)},overlapFoot:function(){this.goalX=Math.floor(10*Math.random()),this.goalY=Math.floor(15*Math.random());for(var e=0;e<this.snakeArrX.length;e++)if(1===this.boxMap[this.goalX][this.goalY]){this.overlapFoot();break}this.produceFoot()},produceFoot:function(){this.nextGoal=Math.floor(7*Math.random()),0===this.nextGoal&&(this.prefab=this.rect0),1===this.nextGoal&&(this.prefab=this.rect1),2===this.nextGoal&&(this.prefab=this.rect2),3===this.nextGoal&&(this.prefab=this.rect3),4===this.nextGoal&&(this.prefab=this.rect4),5===this.nextGoal&&(this.prefab=this.rect5),6===this.nextGoal&&(this.prefab=this.rect6),this.snakeBody=cc.instantiate(this.prefab).getComponent("rect"),cc.find("Canvas/box").addChild(this.snakeBody.node),this.snakeBody.node.x=48*this.goalX,this.snakeBody.node.y=48*this.goalY;var e=this.snakeBody.node.x/48,t=this.snakeBody.node.y/48;this.boxMap[e][t]=1},eatFoot:function(){var e=this.snakeHead.node.x/48,t=this.snakeHead.node.y/48;if(1===this.boxMap[e][t]){var s=this.snakeArrX.length;this.snakeArrX[s]=this.snakeBody.node.x,this.snakeArrY[s]=this.snakeBody.node.y,this.snakeArr[s]=this.snakeBody,this.boxMap[e][t]=0,this.addScore(),this.overlapFoot()}},addScore:function(){0===this.nextGoal&&(this.scoreNum+=50),1===this.nextGoal&&(this.scoreNum+=100),2===this.nextGoal&&(this.scoreNum+=200),3===this.nextGoal&&(this.scoreNum+=300),4===this.nextGoal&&(this.scoreNum+=400),5===this.nextGoal&&(this.scoreNum+=500),6===this.nextGoal&&(this.scoreNum+=600),this.score.string=this.scoreNum},move:function(){0===this.direction?(this.isGameOver(this.snakeHead.node.x,this.snakeHead.node.y+48),1===this.gameState&&(this.snakeHead.node.y+=48)):1===this.direction?(this.isGameOver(this.snakeHead.node.x,this.snakeHead.node.y-48),1===this.gameState&&(this.snakeHead.node.y-=48)):2===this.direction?(this.isGameOver(this.snakeHead.node.x-48,this.snakeHead.node.y),1===this.gameState&&(this.snakeHead.node.x-=48)):3===this.direction&&(this.isGameOver(this.snakeHead.node.x+48,this.snakeHead.node.y),1===this.gameState&&(this.snakeHead.node.x+=48)),1===this.gameState&&(this.eatFoot(),this.moveAll())},moveAll:function(){for(var e=this.snakeArrX.length-1;0<e;e--)this.snakeArrX[e]=this.snakeArrX[e-1],this.snakeArrY[e]=this.snakeArrY[e-1];this.snakeArrX[0]=this.snakeHead.node.x,this.snakeArrY[0]=this.snakeHead.node.y;for(var t=1;t<this.snakeArrX.length;t++)this.snakeArr[t].node.x=this.snakeArrX[t],this.snakeArr[t].node.y=this.snakeArrY[t];cc.log("moveAll"+this.snakeArrX.length)},onKeyDown:function(e){switch(e.keyCode){case cc.KEY.a:case cc.KEY.left:3!=this.direction&&(this.direction=2);break;case cc.KEY.d:case cc.KEY.right:2!=this.direction&&(this.direction=3);break;case cc.KEY.w:case cc.KEY.up:1!=this.direction&&(this.direction=0);break;case cc.KEY.s:case cc.KEY.down:0!=this.direction&&(this.direction=1)}},isGameOver:function(e,t){if(e<0||480<=e||t<0||720<=t)this.gameOver();else for(var s=0;s<this.snakeArrX.length;s++)if(this.snakeArrX[s]==e&&this.snakeArrY[s]==t)return void this.gameOver()},gameOver:function(){this.gameState=2,this.over.active=!0,this.unschedule(this.move),cc.audioEngine.stopAll()},pause:function(){2!==this.gameState&&(1===this.gameState?(this.gameState=0,this.button.string="Play",this.unschedule(this.move)):0===this.gameState&&(this.gameState=1,this.button.string="Pause",this.schedule(this.move,this.speed)))},replay:function(){cc.director.loadScene("snaker")}}),cc._RF.pop()},{}],rect:[function(e,t,s){"use strict";cc._RF.push(t,"20127cQSZ9N0bB8afm8IEjY","rect"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}]},{},["build","rect"]);